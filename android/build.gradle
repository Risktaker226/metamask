// Top-level build file where you can add configuration options common to all sub-projects/modules.

buildscript {
    ext {
        buildToolsVersion = "35.0.0"
        minSdkVersion = project.hasProperty('minSdkVersion') ? project.getProperty('minSdkVersion') : 24
        compileSdkVersion = 35
        targetSdkVersion = 35
        ndkVersion = "26.1.10909125"
        bitriseNdkPath = "/usr/local/share/android-sdk/ndk-bundle"
        kotlin_version = "1.9.25"
        kotlinVersion = "$kotlin_version"
        supportLibVersion = "28.0.0"
    }

    repositories {
        google()
        mavenCentral()
        gradlePluginPortal() // ðŸ‘ˆ ajoutÃ© pour Gradle 9.x (meilleure rÃ©solution des plugins)
    }

    dependencies {
        // âœ… Versions compatibles Gradle 9.x
        classpath("com.android.tools.build:gradle:8.7.2")
        classpath("com.facebook.react:react-native-gradle-plugin")
        classpath("io.sentry:sentry-android-gradle-plugin:4.2.0")
        classpath("com.google.gms:google-services:4.4.2")
        classpath("org.jetbrains.kotlin:kotlin-gradle-plugin:1.9.25")
    }
}

// ðŸ‘‡ Section modernisÃ©e pour Gradle 9.x
allprojects {
    repositories {
        google()
        mavenCentral()
        maven { url "https://jitpack.io" }

        // Detox local
        maven {
            url("$rootDir/../node_modules/detox/Detox-android")
        }

        // Notifee repository
        def notifeePath = ["node", "--print", "require.resolve('@notifee/react-native/package.json')"]
            .execute(null, rootDir)
            .text.trim()
        maven {
            url(new File(notifeePath, "../android/libs"))
        }
    }
}

// âœ… Nouvelle configuration propre Gradle 9 (remplace "task clean(type: Delete)")
tasks.register("clean", Delete) {
    delete rootProject.buildDir
}
